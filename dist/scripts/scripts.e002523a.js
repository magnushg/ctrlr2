"use strict";angular.module("yoAngularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase","highcharts-ng","mgcrea.ngStrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/statistics",{templateUrl:"views/statistics.html",controller:"StatisticsCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("yoAngularApp").controller("MainCtrl",["$scope","automatrService","chartConfigService",function(a,b,c){a.temperature=b.getTemperature(),a.brightness=b.getBrightness(),a.lightswitchToggle=b.lightswitch(),a.lightswitchToggle.$bind(a,"lightToggle"),a.temperature.$on("loaded",function(b){a.thermometerChartConfig=c.createThermometerConfig(b)})}]),angular.module("yoAngularApp").controller("StatisticsCtrl",["$scope","configService","automatrService","chartConfigService",function(a,b,c,d){a.environmentLog=c.environmentLog(),a.temperatureChartConfig={loading:!0},a.brightnessChartConfig={loading:!0},a.environmentLog.$on("loaded",function(b){a.tempLog=_.chain(b).filter(function(a){return void 0!==a.temperature}).map(function(a){return a.temperature}).value(),a.brightnessLog=_.chain(b).filter(function(a){return void 0!==a.brightness}).map(function(a){return a.brightness}).value(),a.temperatureChartConfig=d.createEnvironmentChartConfig("Temperature","spline",a.tempLog,"#910000","°C"),a.brightnessChartConfig=d.createEnvironmentChartConfig("Brightness","spline",a.brightnessLog,"#2f7ed8")})}]),angular.module("yoAngularApp").controller("navCtrl",["$scope","$location",function(a,b){a.navClass=function(a){var c=b.path().substring(1)||"home";return a===c?"active":""}}]),angular.module("yoAngularApp").controller("footerCtrl",["$scope","automatrService",function(a,b){a.heartBeat=b.getHeartBeat()}]),angular.module("yoAngularApp").factory("configService",function(){var a={firebaseEnvironment:"automatr-test"};return{firebaseEnvironment:function(){return a.firebaseEnvironment}}}),angular.module("yoAngularApp").factory("automatrService",["$firebase","configService",function(a,b){var c=b.firebaseEnvironment(),d=new Firebase("https://{0}.firebaseio.com/lightswitch".format(c)),e=new Firebase("https://{0}.firebaseio.com/coffee".format(c)),f=new Firebase("https://{0}.firebaseio.com/temperature".format(c)),g=new Firebase("https://{0}.firebaseio.com/proximity".format(c)),h=new Firebase("https://{0}.firebaseio.com/brightness".format(c)),i=new Firebase("https://{0}.firebaseio.com/environmentLog".format(c)),j=new Firebase("https://{0}.firebaseio.com/heartBeat".format(c));return{getTemperature:function(){return a(f)},getBrightness:function(){return a(h)},getProximity:function(){return a(g)},lightswitch:function(){return a(d)},coffeeToggle:function(){return a(e)},environmentLog:function(){return a(i)},getHeartBeat:function(){return a(j)}}}]),function(){if(!String.prototype.format){var a={};String.prototype.format=function(){for(var b=this,c=arguments,d=c.length;--d>=0;)b=b.replace(a[d]||(a[d]=RegExp("\\{"+d+"\\}","gm")),c[d]);return b},String.format||(String.format=function(b){for(var c=arguments,d=c.length;--d;)b=b.replace(a[d-1]||(a[d-1]=RegExp("\\{"+(d-1)+"\\}","gm")),c[d]);return b})}}(),angular.module("yoAngularApp").filter("userFriendlyBrightness",function(){return function(a){switch(!0){case 15>=a:return"dark";case 200>=a:return"dim";case 500>=a:return"light";case 800>=a:return"bright";case a>800:return"very bright";default:return"No value"}}}),angular.module("yoAngularApp").filter("switchButtonText",function(){return function(a){return a?"Light is ON":"Ligth is OFF"}}),angular.module("yoAngularApp").filter("switchButtonClass",function(){return function(a){return a?"btn btn-success":"btn btn-danger"}}),angular.module("yoAngularApp").factory("chartConfigService",function(){var a=function(a,b,c,d,e){return{options:{chart:{zoomType:"x"}},series:[{name:a,data:_.map(c,function(a){return{x:a.timestamp,y:parseFloat(a.value)}}),pointStart:_.first(c).timestamp,type:b,color:d,marker:{enabled:!1},turboThreshold:0}],title:{text:""},xAxis:{type:"datetime"},yAxis:{title:{text:e||""}},loading:!1,credits:{enabled:!1}}},b=function(a){return{options:{chart:{type:"gauge",plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1},pane:{startAngle:-150,endAngle:150},legend:{margin:0}},title:{text:"",margin:0},yAxis:{min:-30,max:50,minorTickInterval:"auto",minorTickWidth:1,minorTickLength:10,minorTickPosition:"inside",minorTickColor:"#000",tickPixelInterval:30,tickWidth:2,tickPosition:"inside",tickLength:10,tickColor:"#000",labels:{step:2,rotation:"auto"},title:{text:"°C"},plotBands:[{from:-30,to:0,color:"#257ef2"},{from:0,to:50,color:"#a50c26"}]},series:[{name:"temperature",data:[parseFloat(a.value)],tooltip:{valueSuffix:"°C"}}],credits:{enabled:!1}}};return{createEnvironmentChartConfig:a,createThermometerConfig:b}});